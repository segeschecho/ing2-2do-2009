\chapter{Arquitectura}

En esta parte se desarrollará la arquitectura general del producto. Analiceremos estilos arquitectónicos, las tácticas correspondientes para poder contemplar los atributos de calidad y finalmente diferentes estructuras que nos conllevarán a realizar las vistas arquitectónicas apropiadas para lograr un buen entendimiento de las diferentes partes del sistema.

\section{Módulos}

\begin{figure}[!Hb]
    \centering
    \includegraphics[scale = 0.6]{Modulos.png}
\end{figure}

Aquí vamos a mostrar una vista de módulos que nos permitirá analizar básicamente la sección de procesamiento de datos mediante modelos matemáticos en la Estación Central. Vamos a tener una unidad de código encargada de dicho procesamiento de modelos, pero para los cuales van a ser necesarios una serie de módulos que contribuyan a dicho procesamiento.

Entonces ésta vista estará compuesta por los siguientes módulos:

\begin{itemize}
\item Modulo procesamiento: Este módulo es básicamente un  manejador del proceso de obtención parseo y procesamiento de los datos por modelos matemáticos. La idea es que una vez obtenidos los datos los mismos se puedan configurar o adaptar de tal manera que la inclusión de distintos modelos matemáticos no afecte el sistema en general y la modificación sea sencilla.
\item DB INPUT(DATA): Este módulo comprenderá la operatoria asociada a la obtención de los datos a procesar de la base de datos que guarda los mismos previos al procesamiento.
\item DB OUPUT(RESULTADOS): Este módulo comprenderá la operatoria asociada al depósito de los datos una vez procesados a la base de datos que guarda los resultados obtenidos.
\item Parser: El Parser básicamente como mencionamos anteriormente se encarga de configurar la información en datos de modo tal que el intercambio entre distintos modelos matemáticos sea fácilmente configurable
\item Reglas: Finalmente éste modulo es el encargado de tener las reglas de los modelos matemáticos. El módulo de procesamiento hará uso de éste modulo para procesar los datos obtenidos y posteriormente guardar los resultados.
\end{itemize}

La idea de utilizar ésta forma de procesar fue responder fácilmente al intercambio de modelos matemáticos. Al lograr bajo acoplamiento en los módulos y separando el módulo de reglas independientemente del resto de los módulos logramos que intercambiar este módulo de reglas no sea una tarea complicada y poder seguir usando el sistema rápidamente. 

Como se mencionó anteriormente, las reglas estarán traducidas al lenguaje que estemos utilizando y además utilizarán estructuras de datos comunes a todas ellas para referirse a los diferentes datos. De éste modo éstas estructuras estarán fijadas y las reglas operarán sobre ellas sin necesidad de tener sus propias estructuras. Sólo constarán de definiciones de funciones y reglas aplicadas a los datos.

En la prueba de concepto daremos una breve explicación adaptada a dicha prueba para mostrar cómo podría simularse éste módulo.


\clearpage
\newpage

\section{Componentes y conectores}

La primera de las estructuras que vamos a analizar es la asociada a entidades run-time. Para ello utilizaremos vistas de componentes y conectores que nos permitan identificar éstas entidades y poder instanciarlas como componentes o conectores. Esto nos dará una idea de como los diferentes componentes contribuyen a la ejecución de las funcionalidades solicitadas y como las tácticas aplicadas se corresponden al control de los diferentes atributos de calidad. Presentaremos tres vistas de acuerdo a los componentes que funcionan en cada uno de las tres grandes partes que componen nuestro sistema(Terminal Remota, Estación central y Sistema de Monitoreo) y también explicaremos la forma de comunicación y flujo de datos entre dichas partes, por lo cual también puede verse como una vista de Deployment combinada con componentes y conectores. Cada una de las tres vistas se encuentran al final de ésta sección por lo que es aconsejable analizarla en paralelo a medida que se lee la explicación del funcionamiento de las componentes internas.


\subsection{Funcionamiento de las Terminales Remotas}

Las Terminales Remotas represantan los nodos o unidades que sensan y proveen información a la red telemétrica. Tienen a su cargo tareas como:

\begin{itemize}
\item Recopilación de información de sensores.
\item Envío de datos a la EC.
\item Configuración en la Agenda de los Sensores.
\item Minimización del consumo de energía de las baterías.
\item Mantenimiento de Estado de sensores.

\end{itemize}

\subsubsection{Descripción de las componentes de la Terminal Remota}

\begin{itemize}

\item \textbf{Procesador Estado:} Esta componente se encarga de la interacción con la componente muy utilizada en el mercado. Dicha componente proveerá la información acerca del monitoreo de paneles solares y baterías. Una vez obtenida dicha información ésta componente la procesará y determinará las acciones a llevar a cabo, enviando dichas ordenes al Switch Estado.

\item \textbf{Switch Estado:} A partir de las órdenes generadas por el Procesador Estado, ésta componente se encargará de cambiar la forma de obtención de energía por parte de la TR ordenando apagar las baterías y habilitar los paneles solares o viceversa. Finalmente cada vez que se produce un cambio en la fuente de alimentación

\item \textbf{ABM Sensor:} Esta componente es la encargada de llevar a cabo la alta, modificación y baja de sensores en la terminal remota.

\item \textbf{Datos TR:} Esta base de datos tiene la información de los datos que van llegando por parte de los sensores y además el estado general de los mismos. Por otro lado también existe información asociada al consumo de energía de la Terminal Remota.

\item \textbf{Adaptador Sensor:} Los adaptadores de sensores, permiten como su nombre lo indica normalizar los datos provenientes de los distintos sensores. Además es importante su existencia debido a las distintas formas de conexión que tienen cada uno de los sensores con la Terminal Remota. Está asociado a dos conectores de input y dos de ouput por los cuales se llevan a cabo las funcionalidades de configuración de las agendas de los sensores y la llegada de datos por parte de los mismos. Hay un adaptador por cada sensor comunicado con la Terminal Remota.


\item \textbf{Configuración Agenda:} Esta componente se encarga de recibir las órdenes en el cambio de una agenda de un determinado sensor proveniente de la Estación Central y envía dicha información al adaptador del sensor correspondiente.

\item \textbf{Receptor Datos:} Esta componente se encarga de ir almacenando los datos obtenidos por los diferentes sensores para su posterior envío. Además de acuerdo a la frecuencia de envío de los sensores puede determinar si existe alguno de ellos se cayó y avisar de dicha información a la componente de Inf Estado Tr/Sensor.

\item \textbf{Inf Estado Tr/Sensor:} Esta componente se encarga de manejar el estado general de la TR(consumo de energía) y el funcionamiento de los sensores de la misma. Además se encarga de proveer ésta información almacenada en la base de daros Datos TR, a la Estación Central cuando la misma así lo requiera.

\item \textbf{Sincronizador:} El sincronizador se encargará del envío de datos cada 1 minuto a la Estación Central. Es decir, cada un minuto envía la información obtenida por los sensores almacenada en la base de datos aplicando algún algoritmo para solucionar el problema de las distintas frecuencias de envío de los sensores. Una vez armada la transmisión envía dicha información a la componente Comunicación EC.

\item \textbf{Comunicación EC:} Esta componente se encarga del protocolo de comunicación segura y confiable con la Estación central. Dicho protocolo se detallará con mayor detalle posteriormente en éste informe. 

\end{itemize}


\subsubsection{Tácticas elegidas en las Terminales Remotas}

En las terminales remotas se utilizaron tácticas que garanticen de disponibilidad de los datos que se recolectan de los diferentes sensores, antes de ser enviados, y también luego de enviarse, ya que permanecen almacenados hasta que los mismos lleguen a la Estación Central de forma correcta. Se tuvo en cuenta la disponibilidad de toda la TR en si, tratando de evitar que por la caída de algún componente, la TR deje de funcionar, es decir, evitando que deje de censar los datos de los sensores o que deje de enviar los mismos a la Estación Central.

Uno de los componentes mas importantes, el componente relacionado con la comunicación y del envío de datos ($Comunicación$ $EC$), dispone de redundancia pasiva, tratando de disminuir el tiempo en el que la TR se encuentra no disponible para la Estación Central.

Los componentes mas críticos, y que disponen de redundancia activa, son los relacionados con el tratamiento y almacenamiento de los datos obtenidos de los sensores, esto ayuda a lograr los atributos relacionados con la disponibilidad de los datos, de la TR. Estos componentes son: $Receptor$ $Datos$, donde confluyen todos los valores que los sensores envían. El mismo, los toma y los guarda en la base de datos $Datos$ $TR$. Cabe aclarar que este componente, conoce cuantos sensores tiene la TR, y además de esto, también conoce el intervalo de tiempo que cada uno de los sensores tiene para enviar los datos, por lo tanto es el que detecta la posible caída de alguno de ellos, notificándolo al componente $Inf$ $Estado$ $Tr/Sensor$, por eso es importante que no esté fuera de servicio mucho tiempo, con lo cual, la redundancia activa nos permite disminuir este tiempo al mínimo; $Sincronzador$ es el encargado de llevar el estado de los datos en vuelo entre la TR y la Estación Central. Como los datos que se envían, no son eliminados de $Datos$ $TR$ sino hasta que llega la confirmación de su llegada, el $Sincronizador$ tiene como función, limpiar $Datos$ $TR$, dejando solo los datos que van a ser enviados y los que se encuentran en camino y no fueron confirmados. La redundancia activa en este caso permite bajar al mínimo el tiempo en que este componente se encuentra fuera de servicio, ya que los mensajes de confirmación de llegada son considerados críticos para la comunicación confiable; $Datos$ $TR$, lugar donde se guardan todos los valores que se obtienen de los sensores, y como esta información se va modificando cada momento, no es posible implementar una táctica con redundancia pasiva, ya que algunos datos se pueden perder si la componente principal se cae y no llega a actualizar la componente secundaria. por lo tanto es necesario que la información no se pierda, es por esto que se decidió implementar redundancia activa, y donde todos los datos estarán duplicados.

Los componentes que no son demasiado críticos, son aquellos que se encargan de enviar mensajes de un lado a otro y de recibir órdenes para obtener ciertos datos. En estos casos la elección de redundancia pasiva, resultó ser la mejor, ya que cuando uno de los componentes se cae, el secundario toma su lugar y continúa con las tareas sin tener un tiempo muy elevado fuera de servicio. Se considero que este tiempo debía ser pequeño, pero el hecho de utilizar redundancia activa en estos componentes no se justificaba, ya que el margen de este tiempo es aceptable.


\subsection{Funcionamiento de la Estación Central}

La Estación Central representa el gran cerebro del sistema. Tiene a su cargo funcionalidades tales como: 

\begin{itemize}
\item Comunicación con las terminales remotas ya sea para  conocer su estado, para recibir datos o bien para configurar agendas. 
\item  Comunicación con el Sistema de Monitoreo para proveer la información necesaria a agentes externos e internos del sistema.
\item Procesamiento de datos.
\item Estado general del sistema.
\item Estrategias alternativas como triangulaciones, Biggest Satellite, etc.
\item Mantener consistencia, completitud y coherencia en la información.

\end{itemize}

\subsubsection{Descripción de las componentes de la Estación Central}

\begin{itemize}

\item \textbf{Históricos:} Este base de datos contempla la información histórica recopilada por la red telemétrica, es decir todos los datos desde el comienzo de la ejecución del sistema hasta el día actual. Esto sirve para aplicar algoritmos para la detección de posibles outliers o mismo para recuperar y comparar datos históricos con actuales. La implementación de la misma no es necesaria a esta altura del diseño pero según nuestros conocimientos podría llevarse a cabo algún tipo de base de datos similar a un Data Warehouse, lo cual resulta muy cómodo a la hora de tomar decisiones y comparar con datos históricos.

\item \textbf{Resultados:} Esta base de datos va almacenando los resultados del procesamiento de los datos provenientes de las terminales remotas. Esta información es la que necesita verdaderamente ser confiable, precisa y en tiempo real para poder dar a conocer las predicciones correctas acerca del sistema meteorológico.

\item \textbf{Data:} Esta base de datos almacena temporalmente (Suponemos alrededor de un día) los datos provenientes de las distintas terminales remotas a ser procesados, es necesario almacenar ésta información para triangulación y procesamiento correcto de los datos completos.

\item \textbf{Estado:} Esta base de datos contempla el estado de las terminales remotas en tiempo real, ésta información es necesaria para la triangulación y o utilización del sistema Biggest Satellite y para informar en la página web y operarios acerca del estado real del sistema.

\item \textbf{Información/Rollback:} Es necesario llevar a cabo algún tipo del Log o seguimiento de las acciones (llegada de datos, etc) para poder tomar decisiones acerca de la vuelta a estados consistentes en caso de fallas. Esta base de datos lleva a cabo dicho seguimiento.

\item \textbf{Recepción Segura:} Esta componente representa el otro extremo de la comunicación con las terminales remotas. Vamos a suponer que existen muchos de estos componentes asignados estáticamente a cada una de las terminales remotas para evitar cuellos de botella. La componente se encarga del protocolo de comunicación y la seguridad en el envío/recepción de mensajes con las Terminales Remotas asignadas y luego envía ésta información a un divisor de mensajes asignado también estáticamente.

\item \textbf{Divisor mensajes:} Esta componente se encarga de transferir los distintos tipos de mensajes a cada componente asociada a ellos. Los de estado a la componente Estado y los de datos a la componente Data Manager. Es importante reflejar que las transmisiones a este punto ya están completas porque el protocolo de comunicación es llevado a cabo por la componente Recepción Segura.

\item \textbf{Info Tráfico:} Esta componente se encarga de enviar información de tráfico al sistema de monitoreo cuando éste así lo requiera, para ellos en caso de recibir una petición de tráfico particular, consulta a la componente recepción segura que es la que tiene dicha información por la funcionalidad que emplea

\item \textbf{Interfaz SE:} Esta componente se encarga de recibir la información del sistema eólico capturada por el sistema de monitoreo, y transformarla a un formato útil para compararla, luego la envía al Arbitro 1.

\item \textbf{Data Manager:} Esta componente centraliza todos los datos obtenidos por cada una de las Tr, y los va almacenando en Data. Cuando los datos están completos se los envía al Arbitro 1. El data manager también se encarga de ir llevando un Log para en caso de fallas poder regresar a un estado consistente.

\item \textbf{Arbitro 1:} El árbitro 1 compara los datos que son comparables con los del sistema eólico y selecciona los más precisos de acuerdo a la zona de la cual provengan los datos. Por ejemplo se dice que los datos del sistema eólico suelen ser más precisos en el sur del país. Una vez normalizados los datos se los envía al Arbitro 2.

\item \textbf{Arbitro 2:} El árbitro 2 compara los datos con los de la base de datos histórica, los almacena pero además analiza la posible existencia de outliers. En caso de existir envía dicha información al sistema de monitoreo para generar warnings. Un vez analizada ésta información se comunica nuevamente con el Data Manager quien actualiza los datos en la base de datos si así fuese necesario.

\item \textbf{Controlador Estado:} El controlador de estado es la componente encargada de llevar a cabo el estado del sistema y sus posibles transiciones. Es quién cada cierto tiempo consulta el estado de las TR y sus sensores y actualiza la base de datos de estado.Si le llega información en caso de caída de una Terminal Remota se comunica con el Administrador Fallas TR y luego actualiza el estado de dicha TR de acuerdo a la solución obtenida. Es consultado por el Monitor de Estado del Sistema de Monitoreo y se encarga de recibir la información de alta, baja, modificación y de TRs o sensores para actualizar el estado. Cuando se detecta el alta de una Terminal Remota también se comunica con el administrador de Fallas De Para que todo vuelva a funcionar normalmente.

\item \textbf{Administrador fallas Tr:} Esta componente lleva a cabo la solución cuando se detecta la caída de una terminal remota. El primer paso es comunicarse con un triangulador, que en caso de poder triangular lo hace y si no devuelve algún mensaje que no pudo. Si ésto llegase a suceder el administrador de fallas se comunica con el BS Proveedor para que adquiera los servicios correspondientes a Biggest Satellite para la zona en donde la TR se ha caído. Una vez llevado a cabo éste procedimiento se comunica nuevamente con el controlador de estado informando qué solución se llevó a cabo. Finalmente cuando se detecta el alta de la TR nueva mente el administrador de fallas interrumpe la triangulación o la adquisición del sistema Biggest Satellite.

\item \textbf{Triangulador:} Ante la caída de una terminal remota accede a la base de datos de estado para determinar si es posible triangular dicha terminal. En caso de que sea posible accede a la base de datos Data para obtener las mediciones de terminales utilizadas en la triangulación, calcula promedios y luego pasa los datos triangulados a la base de datos Data nuevamente. Si no pudiese triangular, ya sea porque no hay terminales remotas próximas o están caídas simplemente le contesta a Administrador de Fallas que no se pudo triangular.

\item \textbf{BS Proveedor:} En caso de que se necesite usar el servicio BS se comunica con la BS interfaz para que acceda a ellos y luego determina que parte de los datos necesita para esa terminal remota caída. Una vez hecho ésto envía los datos a la base de datos Data y comienza a contar el tiempo transcurrido hasta que se recupere la Tr y se deje de proveer el servicio, enviando el consumo realizado a la Interfaz Pagos.

\item \textbf{BS Interfaz:} Representa la interfaz de acceso al servicio Biggest Satellite mediante un protocolo Cliente-Servidor.

\item \textbf{Interfaz Pagos:} La interfaz de pago almacena los minutos consumidos en el uso de Biggest Satellite, cada cierto tiempo, envía dicha información al Sistema de Monitoreo para transferirla al sistema de pagos.

\item \textbf{Modificación Agenda:} Esta componente recibe las peticiones en la modificación de la agenda para un sensor de una TR en particular, y envía dicha información al divisor de datos asignado a la Terminal Remota cuyo sensor necesita de la configuración.

\item \textbf{Procesamiento:} Cada cierto lapso de tiempo, ésta componente adquiere los datos en la base de datos Data, los últimos válidos, y procesa mediante la aplicación de modelos matemáticos dichos datos. Una vez llevada a cabo ésta tarea notifica al sistema de monitoreo la finalización del procesamiento y guarda los resultados en la base de datos resultados.

\end{itemize}

\subsubsection{Tácticas elegidas en la Estación Central}


En las vistas de arquitectura intentamos mostrar los principales componentes y las tácticas más fáciles de reflejar en un diagrama. De todas formas, hay algunas tácticas que no se aprecian en estas vistas (no las incluimos porque en caso de hacerlo dificultarían la comprensión de las vistas). En ésta sección comentaremos estas tácticas y además ampliaremos sobre las otras tácticas utilizadas, incluyendo una justificación de porque las elegimos.

Como señalamos anteriormente existirán varias componentes Recepción segura, asignadas cada una de ellas a un grupo de terminales remotas determinado (en principio podría ser por zona) de manera estática. Con ésto lo que intentamos reflejar es un balanceo de carga estático para no generar un único cuello de botella, de modo tal de no saturar una única componente, lo que hace que la llegada de datos sea más performante debido a que cada una de ellas recibirá y procesará un subconjunto de los datos recibidos. A su vez cada una de estas componentes tendrá asociado un único divisor de mensajes. Por su parte y ya que logramos performance en la llegada de los datos, éstas componentes no pueden fallar, ya que de hacerlo no estaríamos recibiendo datos de todas las terminales remotas con lo cual atenta a la completitud de la información, es por ellos que existe redundancia activa en éstas dos componentes.

Es importante también notar que todo tipo de comunicación entre partes es segura, ya sea Sistema de Monitoreo-Estación Central o mismo la de la Estación Central  con las terminales remotas. La componente Recepción segura, no sólo se encargará del protocolo de comunicación con las terminales remotas sino que verificará la autenticidad de los datos por alguna modo de codificación y ya que cada terminal remota tendrá un código unívocamente identificatorio se podrá determinar si un mensaje proviene de ella o algún intruso intervino en el medio. 

Como se mencionó la componente recepción segura encargada del protocolo de comunicación y seguridad es la que proveerá un correcto ordenamiento de los mensajes entrantes.

Pasemos a analizar ahora algunas cuestiones relacionadas con la performance y la confiabilidad de los datos procesados lo cual constituye uno de los punto más importantes en nuestro sistema. En general cuando hablamos de redundancia activa estamos considerando una sola componente de redundancia y aclararemos en caso de necesitar más de una. Por ejemplo en el caso de la componente procesamiento vamos a utilizar tres componentes activos, y ésto no sólo nos servirá para disponibilidad y tolerancia a fallas sino también para confiabilidad. Como las tres componentes van a realizar los mismos cálculos (también se intentará lograr una concurrencia o paralelismo de procesos dentro de cada una de las componentes en lo que sea posible) utilizaremos un voter (o Sistema de corroboración)de modo tal de lograr un sistema dúplex en la cual, las tres componentes procesan datos y se evalúa la mayor coincidencia de los mismos (es por ello la elección de un número impar de componentes). Esto nos proporcionará performance y confiabilidad en el procesamiento de los mismos y garantizará por otro lado un buen nivel de disponibilidad de ésta componente.

La existencia de componentes bien diferenciadas para el ABM de diferentes componentes hace que sea menos acoplado el sistema 
y las modificaciones puedan llevarse a cabo a partir de éstas componentes.

Como se definió en la arquitectura cada vez que se procesa información se avisa inmediatamente al sistema de monitoreo, por lo cual en caso de existir algún fenómeno meteorológico crítico el mismo será informado en tiempo y forma.

La interfaz con el sistema eólico en la Estación Central permite que los datos le lleguen al arbitro 1 en un formato comparable con los datos capturados por las terminales remotas, por lo cual la interoperabilidad es garantizada.

Al separar las interfaces con los sistemas externos como usuarios, operarios, otras empresas, etc, en el sistema de monitoreo con el procesamiento de los datos, la información almacenada, etc en la Estación Central probablemente sea más fácil cuestiones relacionadas con la facilidad en los cambios.

Una vez aclaradas éstas cuestiones adicionales al diagrama podemos destacar que utilizamos redundancia activa en todas aquellas componentes que consideramos que su caída es crítica para nuestro sistema y atenta fuertemente a la disponibilidad del mismo. Sin embargo consideramos redundancia pasiva en componentes tales como las interfaces con Biggest Satellite o el triangulador ya que consideramos que como no siempre están en uso exclusivo tenemos un margen de tiempo para corregirlo en caso de fallas. 

Finalmente, para asegurar la disponibilidad de mediciones de cada TR (un punto fundamental del sistema), implementamos la táctica de heartbeat, para poder determinar si una TR está caída. El motivo es muy simple, las TRs ya envían mensajes periódicamente: los datos que envían cada 1 minuto a la estación central (más alguna eventual retransmisión de mensajes). Entonces, lo único que necesitábamos era chequear si hace un cierto tiempo que no se reciben mensajes de cierta TR; con lo cual, utilizar heartbeat tiene un costo casi nulo en este caso, y nos permite detectar una caída rápidamente (esto es fundamental ya que hay que tomar acciones apropiadas inmediatamente).



\subsection{Funcionamiento del Sistema de Monitoreo}

El Sistema de Monitoreo es la parte del sistema encargada de la interfaz con los usuarios, clientes y otros sistemas externos. En este sector se prestarán diferentes servicios, ya sea mediante una interfaz de comunicación directa o mediante Web Services. Estos servicios tienen que ver, en su mayoría, a la visualización de los datos que el sistema tenga disponible en el momento. Éstos datos pueden ser:

\begin{itemize}
\item Los resultados de los datos procesados por la Estación Central, que pueden estar destinados a operarios internos o usuarios , como por ejemplo la página del Ministerio de Infraestructura, o para otros clientes externos que se espera tener en un futuro, como es el caso de la empresa AgroTop.

\item Los datos que se refieren al estado general del sistema en tiempo real, el estado de la conexión entre las TRs y la Estación central, el estado individual de cada TR, cuáles de éstas están funcionando correctamente, cuales fueron trianguladas, y cuales no fueron trianguladas y se está utilizando el sistema satelital Biggest Satelite para obtener los datos de su zona.

\item La información que es enviada en forma de mail a los responsables por alertas que se producen.

\item La recepción de datos provenientes del Sistema Eólico, que son utilizados por la Estación Central para discernir que datos son mas precisos.

\end{itemize}

Como se puede observar, el Sistema de Monitoreo es la gran interfaz que tiene el sistema y por esta raz'on debe cumplir con los atributos de calidad relacionados con la disponibilidad de la informaci'on y la seguridad.

\subsubsection{Descripción de las componentes del Sistema de Monitoreo}

En ésta sección se nombrarán y explicarán los componentes que forman parte del Sistema de Monitoreo, así también como su rol dentro de la arquitectura.

\begin{itemize}

\item \textbf{Interfaz SE:} Esta componente es la encargada de comunicarse con el Sistema Eólico, implementando su protocolo de comunicación, y a su vez se encarga de comunicarse con la Estación Central, para enviarle los datos recibidos a la componente encargado del procesamiento de los mismos. Los dos conectores que esta componente utiliza son seguros.

\item \textbf{Interfaz Pagos:} Esta interfaz se encarga de la transferencia mediante un protocolo sencillo con el Sistema de Pagos de los minutos acumulados por la utilización del Sistema Biggest Satellite, el canal debe ser seguro para que se cobre adecuadamente el uso del servicio.

\item \textbf{ABM Cliente-Sensor-Tr:} Esta componente se encarga básicamente de las funciones de alta, baja y modificación de algún cliente externo, terminal remota o sensor, es por ello que contempla y se comunica con una base de datos que tiene un estado general de dichos elementos. A su vez recibe éstas configuraciones de la consola de mando de los operarios mediante una comunicación segura.

\item \textbf{Programación Agenda:} Esta componente se encarga de enviarle los datos de configuración recibidos por la consola de mando a la Estación Central. La comunicación entre la consola de mando es segura se podría utilizar SSL o similares, cuestiones que probablemente se puedan establecer mejor en las iteraciones de construcción asociadas a dichos casos de uso. 

\item \textbf{Datos:} Esta componente es avisada por la EC cada vez que un lote de datos es procesado por los modelos mátematicos, por lo cual luego de dicho aviso recupera dichos datos de los resultados almacenados en la base de datos(Resultados) y se encarga de transferirla al sistema de visualización.

\item \textbf{Outliers:} Esta componente es notificada por la EC cada vez que se detecta un dato que es considerado de tipo outlier. Luego de recibir esta información, la componente envía estos al componente Visualizaci'on para que se muestre por pantalla y sea analizado por alg'un experto. A esta altura, tenemos conocimiento de que los datos que son outliers, solo deben ser notificados, sin esperar respuesta de la persona que los analice.

\item \textbf{Monitor Tráfico:} La función que cumple esta componente como su nombre lo indica es monitorear el tráfico existente entre los canales de comunicación de la Trs y la EC, para ellos consulta regularmente a una componente en la EC que se encarga de obtener dicha información. Una vez obtenida la información de tráfico, la misma es enviada a las componentes encargadas de la visualización para los operarios como para la que se encarga de proveer dichos servicios a la página web del ministerio. Finalmente ésta componente en caso de detectar un mucho tráfico (cuyos límites serán definidos al momento de implementar ésta funcionalidad) se comunicará con el sistema de alertas (Sistema de mails) para que se informe de dicha situación a los destinatarios de la misma.

\item \textbf{Monitor Estado:} Al igual que la componente anterior monitorea regularmente el estado de las Trs/Sensores, para ello le consulta a una componente en la EC (Estado) quien mantiene una base de datos con dicha información. Es importante destacar que si bien es competente más a una decisión más cercana a la implementación que a la arquitectura, los tiempos de consulta o polling serán de fracciones de segundo para poder tener un sistema lo más parecido a uno en tiempo real. La información recopilada será enviada a las mismas componentes mencionadas anteriormente. 

\item \textbf{Sistema de mails:} EL sistema de mails actúa como las alarmas mencionadas en casos críticos, en caso de que le llegue información para informar, se comunicará con un servidor de mails para enviar las alarmas correspondientes a los destinatarios.

\item \textbf{Visualización:} Esta componente recopila toda la información en tiempo real que le va llegando y la transforma en datos útiles para la visualización de la misma en las consolas de mando de los operarios.

\item \textbf{Servicios Página:} Provee los web services a la página de la infraestructura con la información en tiempo real que va adquiriendo. La comunicación es Cliente(Pagina infraestructura) Servido(Servicios Página).

\item \textbf{Servicios Empresas:} Filtra la información requerida para cada empresa y como la componente anterior la comunicación es mediante el protocolo Cliente Servidor.

\item \textbf{Consola de mando:} Es la componente que se encarga de la comunicación con los operarios, ya sea para mostrar la información(Estado de TRs en colores, Trafico, Etc), así como para cambios en las agendas de los sensores o ABM de TRs, Sensores y Clientes.  

\end{itemize}

\subsubsection{Tácticas elegidas en el Sistema de Monitoreo}

Como ya se sabe, uno de los principales atributos de calidad es que el sistema este disponible en todo momento. Por este motivo, la mayor parte del sistema de monitoreo dispone de algún tipo de redundancia para cubrir este exigencia.

Los componentes de uso mas critico, y que son usados en todo momento, disponen de redundancia activa, ya que permite tener un tiempo mínimo, casi nulo de estado fuera de servicio. Estos componentes son los encargados de brindar la informaci'on en tiempo real y los resultados obtenidos luego de procesar la informaci'on que env'ien las TRs. Esta medida se pens'o para satisfacer el atributo de calidad relacionado con la disponibilidad de los datos hacia los usuarios.

Las componentes de uso menos cr'itico o que no requieren un estado para trabajar (es decir, que tiene una funci'on mas bien de interfaz), utilizan redundancia de tipo pasiva. Esta medida, si bien tiene un tiempo de fuera de servicio un poco mas alto que la redundancia activa, no es un tiempo que se considere alto a la hora de la caída de un componente. Las componentes que utilizan este tipo de redundancia son aquellas que brindan sus funciones a clientes externos, realizan la comunicaci'on con otros sistemas, y realizan tareas que pueden ser tolerables a la ca'ida de un componente por un tiempo un poco mayor (como es el caso de la configuraci'on de la agenda de un sensor).

Por 'ultimo, las componentes que son bastante mas tolerables a fallas, utilizan repuestos. Este es el caso de la Interfaz de Pagos y ABM Cliente-Sensor-TR, que pueden estar un tiempo considerable fuera de servicio.

Estas decisiones ayudan como ya se dijo a los atributos de disponibilidad del sistema. Pero adem'as de esto, las comunicaciones hacia los clientes externos, los usuarios y hasta la comunucaci'on con la Estaci'on Central requieren ser seguras, para evitar que intrusos puedan interferir en los datos que se env'ian en todo momento. Es por esta raz'on que los conectores, hacia el exterior del Sistema de Monitoreo son seguros e implementan algún protocolo que garantice la integridad y la confidencialidad de los mismos. Con esto se cubren los atributos de calidad relacionados con la seguridad de los datos que envía y recibe el sistema a usu'arios y clientes.

\subsection{Comunicación entre la Estación Central y el Sistema de Monitoreo}

Estas dos partes del sistema, están conectadas mediante varios conectores como se puede observar en los diagramas de arquitectura de cada una. Una de las principales características que se puede observar en esta conexión, es el hecho de que los conectores utilizados para el transporte de los datos, son seguros. Esto se debe a que la parte del Sistema de Monitoreo puede estar físicamente separada de la Estaci'on Central, y por este motivo se requerido este tipo de comunicaci'on segura, para evitar que alguien pueda alterar la informaci'on que viaja de una parte a la otra.

A continuaci'on se describir'an los conectores entre estas dos partes, nombrando las componentes que unen. Vale aclarar que cada uno de los conectores que se explicar'an est'an identificados por una etiqueta en los correspondientes diagramas de arquitectura.

\begin{itemize}
\item \textbf{I1:} Este conector une las dos componentes que procesan los datos correspondientes al Sistema E'olico, Interfaz SE de la Estaci'on Central e Interfaz SE del Sistema de monitoreo. Por 'ultimo, este conector es de tipo OneWay.

\item \textbf{T1:} Este conector es el encargado de transportar la informaci'on del tr'afico en la red de comunicaci'on de las TRs que le brinda el componente Info. Tr'afico de la Estaci'on Central al componente llamado Monitor Tr'afico en el Sistema de Monitoreo. Este conector es de tipo Client-Server, donde el extremo cliente en este caso se encuentra en el lado del Sistema de Monitoreo.

\item \textbf{E1:} Es el conector encargado de transportar la informaci'on referida al est'ado de las TRs entre el $Controlador$ $de$ $Estado$ de la EC y el $Monitor$ $de$ $Estado$ en el SM. Este conector es seguro y es de tipo $Client-Server$, donde el cliente se encuentra del lado del SM.

\item \textbf{OL:} Conector encargado de transportar la informaci'on relacionada con los outliers que se detectan en el sistema. Este es seguro y es de tipo $OneWay$, y une el componente $Arbitro2$ de la EC, con $Outliers$ del SM.

\item \textbf{D1:} Conector de tipo $OneWay$, donde se envían las notificaciones desde la componente $Procesamiento$ en la EC a la componente $Datos$ en el SM, indicando que se h'an generado nuevos resultados.

\item \textbf{D2:} Es el complemento del conector D1, y es utlizado para transportar los datos referidos a los resultados de los modelos matematicos. Ya sea cuando hubo una notificaci'on previa, enviada por D1, o cuando alguno de los clientes externos desean obtenerlos. Este conector es de tipo $Client-Server$, donde el cliente se encuentra del lado del SM. Une las componentes $Resultados$ en la EC, con $Datos$ en el SM.

\item \textbf{A1:} Este conector se utiliza para transportar la informaci'on referida a la modificaci'on de la agenda de una TR. Une las componentes $Programaci'on$ $Agenda$ en el SM, con $Modificaci'on$ $Agenda$ en la EC. Este conector es seguro y es de tipo $OneWay$.

\item \textbf{ABM1:} Es el encargado de comunicar el componente $ABM$ $Cliente-Sensor-TR$ del SM con el $Controlador$ $Estado$ de la EC, y de transportar la informaci'on del sensor o TR que se instalo hacia el $Controlador$ $Estado$.Es de tipo $OneWay$.

\item \textbf{P1:} Es el encargado de transportar la informaci'on relacionada al pago por el uso del servicio del sistema de Biggest Satelite. Es de tipo $OneWay$ y comunica las componentes $interfaz$ $Pagos$ en ambas partes.



\end{itemize}

\subsection{Comunicación entre la Estación Central y las Terminales Remotas}
La comunicación entre la Estación Central y las Terminales Remotas es una parte crítica del sistema, ya que es en este conector que se transmiten todas las mediciones que realizan las TRs y se envian a la Estació Central para su procesamiento.

Físicamente, los datos viajan en SMS, Short Text Message mediante la red GSM. Esta comunicación tiene que ser seguro y confiable: se tiene que preservar la integridad y la confidencialidad de la información que se transmite, y tenemos que tener seguridad de que los datos no se pierden durante la transmisión. Como la tecnología GSM no nos provee ni seguridad ni confiabilidad, tuvimos que diseñar un protocolo que si lo haga.

\subsubsection{Seguridad en las comunicaciones}
La forma que se nos ocurrió de transmitir la información de manera segura es utlizar dos mecanismos de seguridad:
\begin{itemize}
	\item Cifrar la información mediante un algoritmo criptográfico (puede ser simétrico o asimétrico) para mantener la confidencialidad de la información
	\item Aplicar al mensaje una función de hash (como SHA1 o MD5) al enviar el mensaje, y verificar que el hash sea correcto cuando se recibe el mensaje. De esta forma, aseguramos la integridad de la información.
\end{itemize}

\subsubsection{Confiabilidad en las comunicaciones}
La comunicación debe ser confiable, es decir debo obtener una confirmación de la recepción. En nuestro protcolo, cada vez que una Termina Remota envía un mensaje a la Estación Central, ésta le envía una respuesta (ACK) a la terminal que emitió el mensaje, como confirmación de la recepción. Además, cada vez que envía un mensaje, la Terminal Remota espera la confirmación por parte de la EC. Si dentro de un lapso definido no recibe esta confirmación, asume que el mensaje se perdió y lo reenvia.

\subsubsection{Ensamblado de mensajes}
Las TR realizan mediciones de muchos datos distintos, que envían a la EC. Puede ocurrir que una trasmisión de mediciones sea lo suficientemente grande como para no entrar en un mensaje SMS (que como su nombre lo indica, están previstos para mensajes cortos). Es por eso que nuestro protocolo tiene que poder soportar, que una misma transmisión lógica de datos, puede ser enviada en distintos SMS.

En cada Terminal Remota, el módulo de la comunicación con la EC se encarga de fragmentar un mensaje si es necesario y enviar cada parte a la estación Central. La respuesta que mencionamos antes, es por fragmento de mensaje, no por mensaje completo.

En la EC, se realiza el proceso inverso: en el módulo de Recepción Segura se reciben los fragmentos de los mensajes y se reensamblan. Este módulo pasa el mensaje una vez que está completo al siguiente módulo, para su posterior procesamiento. Los mensajes son transmitidos la siguiente módulo en orden: aún cuando el mensaje 2 de la TR 1 haya llegado completo, no se lo pasará al siguiente componente hasta que esté completo el mensaje 1 de la TR 1.

\subsubsection{Protocolo}

Para especificar el protocolo con mas formalidad, utilizamos máquinas de estados finitos (FSMs). Son 4:
\begin{itemize}
	\item Una máquina que representa el canal de comunicaciones, por donde circulan los mensajes. Con esta FSM reprentamos las posbilidad de que los mensajes de pierdan.
	\item Una máquina que representa una Terminal Remota (la parte de envío y reenvío de mensajes).
	\item Y dos para la Estación Central: por un lado la fragmentación de mensajes y por otro el envio de la confirmación de recepción.
\end{itemize}

\begin{figure}[!Hb]
    \centering
    \includegraphics[scale = 0.45]{figuras/fsmCanal.png}
    \caption{FSM del Canal de comunicaciones (el medio físico, en este caso la red GSM)}
\end{figure}

\begin{figure}[!Hb]
    \centering
    \includegraphics[scale = 0.3]{figuras/fsmTR.png}
    \caption{FSM de una Terminal Remota}
\end{figure}

\begin{figure}[!Hb]
    \centering
    \includegraphics[scale = 0.4]{figuras/fsmEC.png}
    \caption{FSM que muestra el envio de respuesta de un mensaje}
\end{figure}

\begin{figure}[!Hb]
    \centering
    \includegraphics[scale = 0.8]{figuras/fsmECfrag.png}
    \caption{FSM del Canal de comunicaciones (FSM que muestra el ensamblado de mansajes en la EC}
\end{figure}

\begin{figure}[!Hb]
    \centering
    \includegraphics[scale = 0.6]{TR.png}
\end{figure}

\begin{figure}[!Hb]
    \centering
    \includegraphics[scale = 0.6]{EC.png}
\end{figure}

\begin{figure}[!Hb]
    \centering
    \includegraphics[scale = 0.6]{SisMon.png}
\end{figure}

\newpage

